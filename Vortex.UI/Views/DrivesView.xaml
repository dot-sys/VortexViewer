<Page x:Class="Vortex.UI.Views.DrivesView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Vortex.UI.Views"
      xmlns:viewModels="clr-namespace:Vortex.UI.ViewModels"
      mc:Ignorable="d" 
      d:DesignHeight="650" d:DesignWidth="800"
      d:DataContext="{d:DesignInstance viewModels:DrivesViewModel}"
      Title="Drives"
      Background="Transparent">
<Page.Resources>
    <viewModels:BooleanToBrushConverter x:Key="BoolToBrush"/>
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
</Page.Resources>

    <Border Background="#000000" CornerRadius="0,0,8,8">
        <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
		

        <!-- Tab Selection Buttons -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
            <Button Content="Overview" 
                    Command="{Binding SelectOverviewTabCommand}"
                    Margin="0,0,10,0"
                    Width="120"
                    Height="30"/>
            <Button Content="Connected Drives" 
                    Command="{Binding SelectConnectedDrivesTabCommand}"
                    Margin="0,0,10,0"
                    Width="140"
                    Height="30"/>
            <Button Content="Timeline" 
                    Command="{Binding SelectTimelineTabCommand}"
                    Width="120"
                    Height="30"/>
        </StackPanel>

        <!-- DataGrid Area - Shows current tab's data -->
        <Grid Grid.Row="1">
            <!-- OVERVIEW DataGrid -->
            <DataGrid x:Name="OverviewDataGrid"
                      Style="{StaticResource VortexDataGridStyle}"
                      ItemsSource="{Binding DeviceOverview}"
                      Visibility="{Binding IsOverviewTabSelected, Converter={StaticResource BooleanToVisibilityConverter}}"
                      RowBackground="#000000"
                      AlternatingRowBackground="#0a0a0a"
                      Height="566"
                      Width="1360"
                      Margin="0,0,0,8">
                <DataGrid.ContextMenu>
                    <ContextMenu Style="{StaticResource VortexDataGridContextMenuStyle}">
                        <MenuItem Header="Copy Value" Click="CopyValue_Click"/>
                        <MenuItem Header="Copy Row" Click="CopyRow_Click"/>
                    </ContextMenu>
                </DataGrid.ContextMenu>
                <DataGrid.Columns>
                    <DataGridTemplateColumn Header="" Width="40">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Ellipse Width="12" Height="12" Stroke="Black" StrokeThickness="1"
                                         Fill="{Binding Connected, Converter={StaticResource BoolToBrush}}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="Device Name" Binding="{Binding DeviceName}" Width="250"/>
                    <DataGridTextColumn Header="Label" Binding="{Binding Label}" Width="250"/>
                    <DataGridTextColumn Header="Drive" Binding="{Binding Drive}" Width="60"/>
                    <DataGridTextColumn Header="BusType" Binding="{Binding BusType}" Width="70"/>
                    <DataGridTextColumn Header="Serial" Binding="{Binding Serial}" Width="200"/>
                    <DataGridTextColumn Header="Unique Identifier" Binding="{Binding UniqueIdentifier}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- CONNECTED DRIVES DataGrid -->
            <DataGrid x:Name="ConnectedDrivesDataGrid"
                      Style="{StaticResource VortexDataGridStyle}"
                      ItemsSource="{Binding ConnectedVolumes}"
                      Visibility="{Binding IsConnectedDrivesTabSelected, Converter={StaticResource BooleanToVisibilityConverter}}"
                      RowBackground="#000000"
                      AlternatingRowBackground="#0a0a0a"
                      Height="566"
                      Width="1360"
                      Margin="0,0,0,8">
                <DataGrid.ContextMenu>
                    <ContextMenu Style="{StaticResource VortexDataGridContextMenuStyle}">
                        <MenuItem Header="Copy Value" Click="CopyValue_Click"/>
                        <MenuItem Header="Copy Row" Click="CopyRow_Click"/>
                    </ContextMenu>
                </DataGrid.ContextMenu>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Drive" Binding="{Binding Drive}" Width="60"/>
                    <DataGridTextColumn Header="Disk#" Binding="{Binding DiskNumber}" Width="60"/>
                    <DataGridTextColumn Header="Label" Binding="{Binding Label}" Width="120"/>
                    <DataGridTextColumn Header="FileSystem" Binding="{Binding FileSystem}" Width="100"/>
                    <DataGridTextColumn Header="Size" Binding="{Binding Size}" Width="120"/>
                    <DataGridTextColumn Header="BusType" Binding="{Binding BusType}" Width="100"/>
                    <DataGridTextColumn Header="Serial" Binding="{Binding Serial}" Width="200"/>
                    <DataGridTextColumn Header="PartitionID" Binding="{Binding PartitionID}" Width="*"/>
                    <DataGridTextColumn Header="FormatDate" Binding="{Binding FormatDate}" Width="150"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- TIMELINE DataGrid -->
            <DataGrid x:Name="TimelineDataGrid"
                      Style="{StaticResource VortexDataGridStyle}"
                      ItemsSource="{Binding UsbEvents}"
                      Visibility="{Binding IsTimelineTabSelected, Converter={StaticResource BooleanToVisibilityConverter}}"
                      RowBackground="#000000"
                      AlternatingRowBackground="#0a0a0a"
                      Height="600"
                      Width="1360"
                      Margin="0,0,0,8">
                <DataGrid.ContextMenu>
                    <ContextMenu Style="{StaticResource VortexDataGridContextMenuStyle}">
                        <MenuItem Header="Copy Value" Click="CopyValue_Click"/>
                        <MenuItem Header="Copy Row" Click="CopyRow_Click"/>
                    </ContextMenu>
                </DataGrid.ContextMenu>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp}" Width="150"/>
                    <DataGridTextColumn Header="Device Name" Binding="{Binding DeviceName}" Width="200"/>
                    <DataGridTextColumn Header="Label" Binding="{Binding Label}" Width="120"/>
                    <DataGridTextColumn Header="Drive" Binding="{Binding Drive}" Width="60"/>
                    <DataGridTextColumn Header="BusType" Binding="{Binding BusType}" Width="70"/>
                    <DataGridTextColumn Header="Serial" Binding="{Binding Serial}" Width="200"/>
                    <DataGridTextColumn Header="Unique Identifier" Binding="{Binding VGUID}" Width="*"/>
                    <DataGridTextColumn Header="Action" Binding="{Binding Action}" Width="180"/>
                    <DataGridTextColumn Header="Log" Binding="{Binding Log}" Width="50"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

        <!-- Bottom row: Page info on left, pagination controls on right -->
        <Grid Grid.Row="2" Margin="0,8,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Page info on left -->
            <TextBlock Grid.Column="0" VerticalAlignment="Center" FontSize="11" 
                       Foreground="White">
                <TextBlock.Text>
                    <MultiBinding StringFormat="Page: {0} / {1}">
                        <Binding Path="CurrentPage"/>
                        <Binding Path="TotalPages"/>
                    </MultiBinding>
                </TextBlock.Text>
            </TextBlock>

            <!-- Pagination controls on right -->
            <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                <Button Content="First" Command="{Binding FirstPageCommand}" Margin="0,0,2,0" 
                        ToolTip="Go to first page" FontSize="11"/>
                <Button Content="&lt;&lt;" Command="{Binding Prev5PagesCommand}" Margin="0,0,2,0" 
                        ToolTip="Previous 5 pages" FontSize="11"/>
                <Button Content="&lt;" Command="{Binding PrevPageCommand}" Margin="0,0,2,0" 
                        ToolTip="Previous page" FontSize="11"/>
                <TextBlock VerticalAlignment="Center" Margin="4,0,4,0" FontSize="11" 
                           Foreground="White">
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{}{0} / {1}">
                            <Binding Path="CurrentPage"/>
                            <Binding Path="TotalPages"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
                <Button Content="&gt;" Command="{Binding NextPageCommand}" Margin="2,0,0,0" 
                        ToolTip="Next page" FontSize="11"/>
                <Button Content="&gt;&gt;" Command="{Binding Next5PagesCommand}" Margin="2,0,0,0" 
                        ToolTip="Next 5 pages" FontSize="11"/>
                <Button Content="Last" Command="{Binding LastPageCommand}" Margin="2,0,0,0" 
                        ToolTip="Go to last page" FontSize="11"/>
            </StackPanel>
        </Grid>
    </Grid>
    </Border>
</Page>
